<html>
    <head>
    
    <style>
        #canvas {
            border: 1px solid black;
            /* cursor:crosshair */
        }        
    </style>
    
<head>

    <body>
    
        <canvas id="canvas"></canvas>
        <input id="submit" onclick="submit()" type="submit">

    <script>

        let githubToken = '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';

        canvas.onmousedown = function(e) { 
            let ctx = canvas.getContext('2d');
            ctx.beginPath();

            function MouseMove(e) {
                ctx.lineTo(e.clientX, e.clientY);
                ctx.stroke();
            }

            this.addEventListener('mousemove', MouseMove);
            
            this.onmouseup = function(e) {
                this.removeEventListener('mousemove', MouseMove);
                this.onmouseup = null;
            };
        };

        submit.onclick = async function(e) {
            let imgBlob = await new Promise(res => canvas.toBlob(res, 'image/jpeg'));
            let response = await fetch('https://api.github.com/repos/shuburana/testRepo/contents/testRepo/image', {
                method: 'POST',
                headers: {
                    'Authorization': `token ${githubToken}`,
                    'Accept': 'application/vnd.github.v3+json',
                },
                body: imgBlob
            });

            if(response.ok) {
                console.log(response.status)

                let result = await response.json();
                console.log(result.message)
            } else {
                console.log('error ' + response.status)
            }
        };

    </script>

    <style>
    </style>    
    
</body>

</html>